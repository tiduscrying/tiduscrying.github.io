---
layout: post
title:  "The $49* ThinkPad T440P"
date:   2022-02-14 16:01 -0500
categories: thinkpad
---
![stinky](https://github.com/tiduscrying/tiduscrying.github.io/raw/main/_images/t440p/Snipaste_2022-02-14_16-15-51.png)

_*actually it ended up costing quite a bit more than that_

# How We Got Here (Prelude)
A few years ago I refurbished a T440S for my girlfriend and gave it to her for school. At the time, I had set it up as a Mojave Hackintosh with Clover. Fast-forward a few years and she eventually purchased a new M1 MacBook Pro (since she needed an _actual_ Mac for work that would be a lot more reliable than something pasted together with glue and config files). Understandable. Realizing she didn't need it anymore, I figured I would take the T440S and mess with it some more. 

So now I had another toy to mess with. Not realizing the immediate limitations of the T440S (non-socketed CPU, internal battery, low res screen, clunkpad, etc), I started ordering some parts. 

The first thing I swapped out was the (apparently) well-hated "Clunkpad". This was a bit of a bitch to get taken care of (and was no different on the T440P, either), but was overall worth it. The original trackpad kind of sucks and has softer, almost scissor-key like switches arranged in a 2x2 grid instead of a traditional clicking mechanism. The actual right/left click buttons were now more just "zones" that really did not feel satisfying to use. Even with the TrackPoint still being present, the lack of those physical buttons on the top of the trackpad as well meant it just felt really gross to use no matter how you wanted to use it.

Clunkpad replaced, I figured I would toss in a M2. SATA SSD and install a fresh copy Arch Linux onto it. This was _kind_ of a disaster in of itself. I ended up ordering a "KingShark *GAMING* SSD" for $70 since it had pretty favorable reviews and was a compatible with the M2 SATA 2240 slot inside the T440S. After attempting and failing to install Arch from scratch using the `archinstall` command, I moved on to EndevourOS which more or less worked. At some point, I decided I wanted to try BRTFS as the file system, and for _some reason_ the whole DRIVE went tits up after that. The BIOS no longer saw the SSD at all and only spat out an error about the drive being un-usable. Chalking it up to maybe a bad drive, I ordered a replacement off Amazon and tried again only for the same issue to happen. At this point, I decided to forget about the drive, but in doing research to fix the problems of the T440S, seeing artciles and videos on the T440P... _really_ caught my eye. The way I saw it, the T440P just had so much _more_ fiddling potential.

Pretty much scrapping the stuff I had done with the T440S entirely, I put the original clunkpad back in it, installed Windows 10 pro and gave it to a family member to worry about. 
A day or so on eBay and I saw **the listing**. The _ultimate_ listing. No display, no keyboard, no HDD, no RAM. Sold AS-IS with a broken display. $49 + $20 shipping, "Buy It Now". The perfect project laptop for me to waste the next few weeks on. **Sold**. 

# Nothing Goes According To Plan (Part I)
To get the show started for my new T440P, I went ahead and ordered some replacement parts that I knew I would need based on the eBay listing. I used the _excellent_ Octoperf guide about the T440P [here](https://octoperf.com/blog/2018/11/07/thinkpad-t440p-buyers-guide) along with the convenient Lenovo Hardware Manual and FRU list to source things. Among the first batch of things was a 1080P replacement panel (I decided to go with the N140HCE-EN1 Rev. C2 due to its lower power consuption), an 8GB stick of DDR3L RAM, and a backlit English keyboard (Made by Chicony; FRU 04x0139). I wanted to add a few additional things such as USB-C charging, an upgraded processor, and a battery, so I went ahead and ordered those items as well. 

Few days pass and the parts start trickling in, first with the new display and keyboard, finally followed by the unit itself. Despite such a low asking price and the missing parts, it was in decent enough shape. No major scratches or scuffs on the housing, no chipped or peeling coatings, and all of the screws and internal stuff was in-tact (aside from the HDD caddy). Time to get to work!

After replacing the display, installing the new RAM and SSD (instead of the KingShark Gaming drive, I went with a more well-known brand and got a Transcend 256GB drive instead. I also ditched the idea of doing anything BTRFS related for the time being) and seating the new keyboard I fired the machine on for the first time and got... _5 beeps_... This... Was not good. I knew this was not good. 5 Beeps? _5 beeps?_ The lights on the keyboard and power button would come on no problem, and even the CPU fan kicked on after a bit, but I was getting absoutely _nothing_ on the display. I tried a few things at first, mostly just re-seating the RAM and SSD. Trying the other slot for the RAM, without the SSD entirely, then eventually with neither to see if the beep-code would change. Nada. 

I did some digging and got worried pretty quickly. 5 beeps, according to all the threads I found and even Lenovo's documentation, pointed towards an issue with the motherboard. I felt immediately defeated before any of the real fun even began. I told myself it was no big deal since I didn't spend a whole lot on it yet _anyways_, but I still felt dumb for buying something I couldn't guarantee worked in the first place. 

I thought of a few solutions that could fix the issue without confronting the idea that the motherboard was toast entirely just yet. I ordered a replacement CMOS battery and main battery off Amazon. After installing the CMOS battery, I looked up ways to possibly try and get a signal from the laptop, but didn't have much luck. I thought about maybe trying to recover the BIOS using something like "WINCRISIS", but any attempts at that I saw online were vague and out-dated, usually ending in the original poster saying they either couldn't get it working or that they just gave up all together. At this point, I had only tried getting a VGA signal out of the laptop and didn't have any mini-display port adapters on hand to try. Given that I didn't get any signal through VGA, I ditched the idea of an external display and resumed just trying to get any signal at all on the replacement panel. My next options were becoming increasingly clear; either get a replacement motherboard, a new CPU (I saw some threads saying a bad CPU would also cause 5 beeps) or try to recover the BIOS using an external flasher. I went with all three. 

# Recovering the BIOS
![stinky](https://github.com/tiduscrying/tiduscrying.github.io/raw/main/_images/t440p/PXL_20220113_041901083.jpg)

Now in the past, I've modified BIOSes before. I just really didn't like it because of how finnicky I found it. The first time I did anything was with my first-ever ThinkPad -- a X220 -- that I wanted to hackintosh. I did it all over again with a X230 about a year later (but ended up using ivyrain after my flasher started being annoying and not consistently reading). I had also modified the BIOS of that T440S to allow for non-whitelisted Lenovo wireless cards for MacOS. I recall the process being a bit dodgy... Pretty much I had to dump the BIOS using an external programmer (I used a CH341a) and send it to a guy through a BIOS modding forum to get it taken care of. It wasn't the most legit way to do things, but the site was discussed a lot and plenty of people were in the same thread with success stories, so I went ahead and PM'ed the fellow. Got my modified BIOS probably not even 30 minutes later and proceeded to flash. It worked and I sent the guy a tip via PayPal for his services. 

Fast forward to now, apparently BIOS Modding for things like the wireless card whitelist removal has become well documented and doable to just about anyone with an external flasher. Not knowing whether or not the BIOS was corrupted with my motherboard, I attempted to dump it using my X230. Problem is, the CH341a flasher worked, but the little clips I had to dump the BIOS chip had become quite lose and weren't getting a solid enough connection to the chip. Multiple, frustrating attempts at getting the chip to read in both Windows and Linux proved unsuccessful. I was soon losing confidence in myself, but knew I also had the replacement motherboard and processor on the way, so if I truly beefed things up I could still move on. 

I also ordered some replacement clips off Amazon and tried again a few days later. To my surprise, it worked immediately! Way better than the clips I had before, plus it was _also_ a two pack. Really nice stuff! 

I dumped the BIOS twice and verified my dumps -- both of them matched. I tried to figure out how to get a clean version of the BIOS installed, given that I couldn't get any video. First thing I tried was to download an image of the most recent BIOS off Lenovo's site and extract the BIOS files. This got a bit messy and I am not going to confidently say I understand everything I was trying. At one point I was trying to extract BIOS "blobs" to compare to the broken BIOS and see if I could replace parts of it or just flash the new one as-is. That didn't end up working and I was getting very annoyed. There weren't any super well documented recovery stories online either. I saw one thread with a person in a similar situation trying to extract a clean BIOS from Lenovo's updater, but they didn't go into much detail.

Eventually, I got a dangerous idea. Remembering those sites with people requesting whitelist removals, I found a few people that opted to just upload their BIOS dumps in the thread itself instead of sending them directly to someone. I knew it was a long shot and might not work, but I downloaded some random dump of someone's T440P and proceeded to flash it. Flashing externally always kind of struck me as _true hacker shit_, so I was very anxious whether or not it would work, but hoped it would because of how baddass it would feel to overcome a problem like this. Flash successfully went through and then... _Nothing_. 

I was no longer stuck getting just 5 beeps, but I still had no video out and nothing seemed to be responding. The fan was still kicking on and ramping down, but nothing appeared to be different than before other than it no longer beeping. I felt... Frustrated. So close, yet somehow still so far. I gave up for the time being and came back to the project a day or two later after purchasing a Mini Displayport to HDMI adapter. I plugged everything in to my main monitor and _it actually fucking worked!_ 

So what the hell was going on with the display? Did I somehow maybe short something? Did the motherboard have liquid damage or something, or was the video cable messed up? I attempted taking the entire laptop apart to inspect _everything_, but never considered the most obvious thing; the replacement display itself. Sure enough, I took the bezel off the display and inspected the plug and BEHOLD! The cable connecting the motherboard to the new panel itself had become unplugged! I felt _so stupid_, but also relieved. After tearing things down and reassembling the laptop a few times at this point, replacing the motherboard itself seemed like a true pain in the ass. Something this simple staring me in the face this whole time just goes to show that you always have to check the simple stuff. 

After reseating the connection and securing it with some electrical tape, I put the bezel back on and everything was working as intended. First _massive_ hurdle overcome, but still plenty of little bumps in the road to come. At this point, I am curious if the BIOS was truly broken beforehand or not. For all I know, I was getting _some_ sort of signal to the panel, but couldn't see it because it was unplugged. That being said though, it worked now so I stopped worrying about it and kept going. 

Next order of business was to install an OS and get the flashed BIOS up-to-date. I started with just basic Windows 10 on a 2.5" SSD. The flashed BIOS I had downloaded was version `2.56`, but Lenovo was already up to `2.77`. Apparently they have been supporting the T440P with updates to vulnerabiliies for quite some time, which is nice to see. Luckily, the update went without issues and everything appeared to be working in the OS. At this point, I already had a replacement motherboard set to arrive in the mail in a few days, but I felt as if messaging the seller and trying to send it back wouldn't be worth it at this point. The replacement board wasn't _too_ expensive and I figured having a spare would be convenient if things went south again.

To my genuine surprise, the motherboard I had was one with a discrete Nvidia 730M GPU. I had read beforehand that this model was "not worth it" due to the poor performance overall of the 730M compared to the Intel HD graphics and additional performance drawbacks that came from having a discrete GPU. The replacement motherboard I had on the way appeared to be one without the Nvidia GPU, so I had my options if things didn't work out with this board. 
